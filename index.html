<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Army War Card Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial Black', Arial, sans-serif;
            background: linear-gradient(135deg, #1a4d2e 0%, #2d5a3d 50%, #3d5a42 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            width: 100%;
        }

        .title {
            text-align: center;
            color: #ffd700;
            font-size: 3em;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.8);
            margin-bottom: 20px;
            letter-spacing: 3px;
        }

        .setup-screen, .game-screen {
            background: rgba(0,0,0,0.7);
            border: 4px solid #ffd700;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 0 30px rgba(255,215,0,0.3);
        }

        .setup-screen h2 {
            color: #ff6b35;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2em;
        }

        .mode-selection {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .mode-btn {
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            color: white;
            border: none;
            padding: 20px 40px;
            font-size: 1.2em;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .mode-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.4);
        }

        .mode-btn.selected {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            border: 3px solid #ffd700;
        }

        .ai-count {
            text-align: center;
            color: white;
            margin-bottom: 20px;
        }

        .ai-count label {
            font-size: 1.3em;
            margin-right: 15px;
            color: #ffd700;
        }

        .ai-count button {
            background: #555;
            color: white;
            border: 2px solid #ffd700;
            padding: 10px 20px;
            margin: 0 10px;
            font-size: 1.2em;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .ai-count button:hover {
            background: #777;
        }

        .ai-count .count {
            font-size: 2em;
            color: #ff6b35;
            font-weight: bold;
            margin: 0 20px;
        }

        .start-btn {
            display: block;
            margin: 30px auto 0;
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 20px 60px;
            font-size: 1.5em;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: all 0.3s;
        }

        .start-btn:hover {
            transform: scale(1.05);
        }

        .hidden {
            display: none;
        }

        .battlefield {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .player-area {
            background: rgba(255,255,255,0.1);
            border: 3px solid #ffd700;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }

        .player-name {
            color: #ffd700;
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        .cards-left {
            color: #ff6b35;
            font-size: 1.2em;
            margin-bottom: 15px;
        }

        .card {
            width: 120px;
            height: 170px;
            background: linear-gradient(135deg, #2c3e50, #34495e);
            border: 3px solid #ffd700;
            border-radius: 10px;
            margin: 10px auto;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 2em;
            color: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            transition: all 0.3s;
        }

        .card.winner {
            border-color: #4CAF50;
            box-shadow: 0 0 30px rgba(76, 175, 80, 0.8);
            transform: scale(1.1);
        }

        .card-rank {
            font-size: 1.5em;
            font-weight: bold;
        }

        .card-suit {
            font-size: 2em;
            margin-top: 5px;
        }

        .card.hearts, .card.diamonds {
            color: #ff4444;
        }

        .card.clubs, .card.spades {
            color: #ffffff;
        }

        .battle-btn {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 20px 50px;
            font-size: 1.5em;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            display: block;
            margin: 0 auto;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: all 0.3s;
        }

        .battle-btn:hover {
            transform: scale(1.05);
        }

        .battle-btn:disabled {
            background: #555;
            cursor: not-allowed;
            opacity: 0.5;
        }

        .message {
            text-align: center;
            color: #ffd700;
            font-size: 1.5em;
            margin: 20px 0;
            min-height: 40px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }

        .game-over {
            text-align: center;
            padding: 40px;
        }

        .game-over h2 {
            color: #ffd700;
            font-size: 3em;
            margin-bottom: 20px;
        }

        .game-over .winner-name {
            color: #4CAF50;
            font-size: 2em;
            margin-bottom: 30px;
        }

        .restart-btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 20px 50px;
            font-size: 1.5em;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: all 0.3s;
        }

        .restart-btn:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">‚≠ê ARMY WAR ‚≠ê</h1>

        <div class="setup-screen" id="setupScreen">
            <h2>Choose Your Battle Mode</h2>
            <div class="mode-selection">
                <button class="mode-btn" onclick="selectMode('pvp', this)">2 Players</button>
                <button class="mode-btn selected" onclick="selectMode('ai', this)">VS AI</button>
            </div>
            <div class="ai-count" id="aiCount">
                <label>Number of AI Opponents:</label>
                <button onclick="changeAI(-1)">-</button>
                <span class="count" id="aiCountDisplay">1</span>
                <button onclick="changeAI(1)">+</button>
            </div>
            <button class="start-btn" onclick="startGame()">START BATTLE!</button>
        </div>

        <div class="game-screen hidden" id="gameScreen">
            <div class="message" id="message">Press BATTLE to begin!</div>
            <div class="battlefield" id="battlefield"></div>
            <button class="battle-btn" id="battleBtn" onclick="battle()">BATTLE!</button>
        </div>
    </div>

    <script>
        let gameMode = 'ai';
        let aiCount = 1;
        let players = [];
        let currentCards = [];
        let warPot = [];
        let backgroundMusic;
        let audioContext;

        // Create cannon sound effect using Web Audio API
        function playCannonSound() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
            
            const now = audioContext.currentTime;
            
            // Create oscillator for explosion
            const osc = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            osc.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            // Cannon boom sound
            osc.frequency.setValueAtTime(150, now);
            osc.frequency.exponentialRampToValueAtTime(50, now + 0.1);
            osc.frequency.exponentialRampToValueAtTime(30, now + 0.3);
            
            gainNode.gain.setValueAtTime(0.8, now);
            gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.5);
            
            osc.start(now);
            osc.stop(now + 0.5);
            
            // Add noise for explosion effect
            const bufferSize = audioContext.sampleRate * 0.3;
            const buffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
            const output = buffer.getChannelData(0);
            
            for (let i = 0; i < bufferSize; i++) {
                output[i] = (Math.random() * 2 - 1) * Math.exp(-i / (bufferSize / 3));
            }
            
            const noise = audioContext.createBufferSource();
            const noiseGain = audioContext.createGain();
            noise.buffer = buffer;
            noise.connect(noiseGain);
            noiseGain.connect(audioContext.destination);
            
            noiseGain.gain.setValueAtTime(0.3, now);
            noiseGain.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
            
            noise.start(now);
        }

        // Initialize background music
        function initBackgroundMusic() {
            if (!backgroundMusic) {
                backgroundMusic = new Audio('https://github.com/TitanBusinessPros/War-Card-Game/raw/main/War%20Theme%20Song.mp3');
                backgroundMusic.loop = true;
                backgroundMusic.volume = 0.3;
                backgroundMusic.play().catch(e => console.log('Audio autoplay prevented'));
            }
        }

        function selectMode(mode, element) {
            gameMode = mode;
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('selected'));
            if (element) {
                element.classList.add('selected');
            }
            document.getElementById('aiCount').style.display = mode === 'ai' ? 'block' : 'none';
        }

        function changeAI(delta) {
            aiCount = Math.max(1, Math.min(3, aiCount + delta));
            document.getElementById('aiCountDisplay').textContent = aiCount;
        }

        function createDeck() {
            const suits = ['‚ô†', '‚ô•', '‚ô¶', '‚ô£'];
            const ranks = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
            const deck = [];
            
            for (let suit of suits) {
                for (let i = 0; i < ranks.length; i++) {
                    deck.push({ rank: ranks[i], suit: suit, value: i + 2 });
                }
            }
            
            return shuffle(deck);
        }

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function startGame() {
            initBackgroundMusic();
            document.getElementById('setupScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');
            
            const deck = createDeck();
            const numPlayers = gameMode === 'pvp' ? 2 : aiCount + 1;
            players = [];
            
            for (let i = 0; i < numPlayers; i++) {
                const isAI = gameMode === 'ai' && i > 0;
                players.push({
                    name: isAI ? `AI Soldier ${i}` : `Player ${i + 1}`,
                    cards: [],
                    isAI: isAI
                });
            }
            
            // Deal cards
            deck.forEach((card, i) => {
                players[i % numPlayers].cards.push(card);
            });
            
            renderBattlefield();
        }

        function renderBattlefield() {
            const battlefield = document.getElementById('battlefield');
            battlefield.innerHTML = '';
            
            players.forEach((player, index) => {
                const area = document.createElement('div');
                area.className = 'player-area';
                area.innerHTML = `
                    <div class="player-name">${player.name}</div>
                    <div class="cards-left">Cards: ${player.cards.length}</div>
                    <div class="card" id="card-${index}">
                        <div style="font-size: 1em;">Ready</div>
                    </div>
                `;
                battlefield.appendChild(area);
            });
        }

        function battle() {
            if (players.some(p => p.cards.length === 0)) {
                endGame();
                return;
            }

            document.getElementById('battleBtn').disabled = true;
            currentCards = [];
            
            // Draw cards
            players.forEach((player, i) => {
                if (player.cards.length > 0) {
                    const card = player.cards.shift();
                    currentCards.push({ card, playerIndex: i });
                    displayCard(i, card);
                }
            });
            
            setTimeout(() => {
                resolveRound();
            }, 1000);
        }

        function displayCard(playerIndex, card) {
            const cardEl = document.getElementById(`card-${playerIndex}`);
            cardEl.className = `card ${card.suit === '‚ô•' || card.suit === '‚ô¶' ? 'hearts' : 'clubs'}`;
            cardEl.innerHTML = `
                <div class="card-rank">${card.rank}</div>
                <div class="card-suit">${card.suit}</div>
            `;
        }

        function resolveRound() {
            const maxValue = Math.max(...currentCards.map(c => c.card.value));
            const winners = currentCards.filter(c => c.card.value === maxValue);
            
            if (winners.length === 1) {
                const winner = winners[0];
                const allCards = [...currentCards.map(c => c.card), ...warPot];
                players[winner.playerIndex].cards.push(...shuffle(allCards));
                warPot = [];
                
                document.getElementById(`card-${winner.playerIndex}`).classList.add('winner');
                document.getElementById('message').textContent = `${players[winner.playerIndex].name} wins this battle!`;
                
                setTimeout(() => {
                    document.querySelectorAll('.card').forEach(c => c.classList.remove('winner'));
                    renderBattlefield();
                    checkGameOver();
                }, 1500);
            } else {
                // WAR!
                playCannonSound();
                document.getElementById('message').textContent = '‚öîÔ∏è WAR! ‚öîÔ∏è';
                warPot.push(...currentCards.map(c => c.card));
                
                // Each player in war puts 3 cards face down
                winners.forEach(w => {
                    const player = players[w.playerIndex];
                    const cardsToAdd = Math.min(3, player.cards.length);
                    warPot.push(...player.cards.splice(0, cardsToAdd));
                });
                
                setTimeout(() => {
                    currentCards = [];
                    winners.forEach(w => {
                        if (players[w.playerIndex].cards.length > 0) {
                            const card = players[w.playerIndex].cards.shift();
                            currentCards.push({ card, playerIndex: w.playerIndex });
                            displayCard(w.playerIndex, card);
                        }
                    });
                    
                    setTimeout(() => {
                        resolveRound();
                    }, 1000);
                }, 1500);
            }
        }

        function checkGameOver() {
            const activePlayers = players.filter(p => p.cards.length > 0);
            if (activePlayers.length === 1) {
                endGame();
            } else {
                document.getElementById('battleBtn').disabled = false;
            }
        }

        function endGame() {
            const winner = players.reduce((max, p) => p.cards.length > max.cards.length ? p : max);
            
            document.getElementById('gameScreen').innerHTML = `
                <div class="game-over">
                    <h2>üéñÔ∏è VICTORY! üéñÔ∏è</h2>
                    <div class="winner-name">${winner.name} Wins!</div>
                    <div style="color: white; font-size: 1.3em; margin-bottom: 30px;">
                        Final Cards: ${winner.cards.length}
                    </div>
                    <button class="restart-btn" onclick="location.reload()">NEW BATTLE</button>
                </div>
            `;
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            const aiBtn = document.querySelectorAll('.mode-btn')[1];
            if (aiBtn) {
                aiBtn.classList.add('selected');
            }
            document.getElementById('aiCount').style.display = 'block';
        });
    </script>
</body>
</html>
